# 📖 活動報到小幫手 v2.0 — 完整操作指南

這份指南包含最新實裝的 **Email 寄送功能**、**手機連網設定** 以及 **HTTPS 相機授權**。

---

### 🖥️ 第一階段：電腦端設定與啟動

#### 1. 設定 Webhook 通知環境（僅需設定一次）
在使用 Teams 通知功能前，請開啟專案目錄下的 `.env` 檔案，填入 Power Automate 提供的 Webhook URL：
```env
TEAMS_WEBHOOK_URL=https://您的_webhook_網址
EVENT_NAME=我的精彩活動名稱
```

#### 2. 啟動系統
使用終端機切換至開發目錄並啟動：
```bash
cd C:\temp_dev\EventRegistrationAssistant
npm start
```
*   **後端 API**：`http://localhost:3001`
*   **前端網址 (HTTPS)**：`https://localhost:5173`
*   **手機連入網址**：`https://[您的電腦IP]:5173`

---

### 📋 第二階段：活動前準備（電腦端）

1.  **進入上傳頁面**：開啟瀏覽器前往 `https://localhost:5173/`。
    *   *注意：若瀏覽器顯示安全性警告，請點選「進階」並「繼續前往」。*
2.  **上傳 CSV 名單**：
    *   準備一個包含「姓名」與「Email」欄位的 CSV。
    *   將檔案拖入虛線框，按下 **「開始上傳與產生 QR Code」**。
    *   系統會自動檢查重複資料並產生專屬代碼與 QR Code。
3.  **發送 Teams 通知**：
    *   上傳成功後，點擊下方的 **「發送 Teams 通知給所有人」** 按鈕。
    *   系統會透過設定檔中的 Webhook，自動將每位參加者的資料（含 QR Code）推播到您的 Teams / Power Automate 流程中。

---

### 📱 第三階段：活動現場（手機/平板操作）

1.  **連入系統**：確認手機與電腦連接同一個 WiFi，開啟瀏覽器輸入 `https://[您的電腦IP]:5173`。
2.  **安全性授權**：
    *   手機瀏覽器會顯示高度警告，請點選 **「進階/詳細資訊」** $\rightarrow$ **「繼續前往/參觀網站」**。
3.  **開啟報到選單**：點擊右上角 **漢堡選單 (☰)** 選擇 **「現場報到」**。
4.  **掃碼報到**：
    *   點擊 **「📷 開始掃描」**，並在彈出的視窗選擇 **「允許相機權限」**。
    *   對準參加者出示的 QR Code。
    *   **成功回饋**：手機會震動並發出「嗶」一聲，顯示綠色成功畫面。
    *   **重複報到**：顯示橘色警告並發出兩聲短音。
5.  **手動輸入**：若環境光線不足，可直接在下方輸入框輸入 **6 碼代碼** 按下「報到」。

---

### 📊 第四階段：活動監控與統計（電腦端）

1.  **監控進度**：前往 **「統計儀表板」**。
2.  **視覺化看板**：上方有 **SVG 環形進度圖**，即時顯示目前的報到率百分比。
3.  **檢索名單**：使用搜尋框輸入姓名或 Email 快速過濾參加者。
4.  **匯出成果**：活動結束後，點擊 **「匯出 CSV」**，即可下載包含所有報到時間的完整名單。

---

### 💡 故障排除 Q&A

*   **Q: 手機連不上網址？**
    *   A: 檢查手機是否與電腦在同一個 WiFi，並確認防火牆是否允許 Port 5173 & 3001。
*   **Q: 相機畫面全黑？**
    *   A: 請確認網址開頭是 `https://` 而非 `http://`。
*   **Q: Email 寄不出去？**
    *   A: 檢查 `.env` 設定是否正確，若使用 Gmail 請務必使用「應用程式密碼」。
